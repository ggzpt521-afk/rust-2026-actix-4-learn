# LangChain è¯¦è§£

> **å®˜æ–¹æ–‡æ¡£**ï¼šhttps://python.langchain.com/docs

## æ¡†æ¶ä»‹ç»

LangChain æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºå’Œç®¡ç†åŸºäºè¯­è¨€æ¨¡å‹ï¼ˆLanguage Models, LMï¼‰çš„åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—å·¥å…·å’Œç»„ä»¶ï¼Œå¸®åŠ©å¼€å‘è€…æ›´é«˜æ•ˆåœ°æ„å»ºã€è®­ç»ƒã€éƒ¨ç½²å’Œç®¡ç†è¯­è¨€æ¨¡å‹åº”ç”¨ã€‚

**è®¾è®¡ç›®æ ‡**ï¼šç®€åŒ–è¯­è¨€æ¨¡å‹çš„ä½¿ç”¨è¿‡ç¨‹ï¼Œä½¿å…¶æ›´åŠ å®¹æ˜“è¢«é›†æˆåˆ°å„ç§åº”ç”¨åœºæ™¯ä¸­ã€‚

**ä¸ºä»€ä¹ˆå¤§ç«**ï¼šLangChain æä¾›äº†ä¸€ç³»åˆ—æ–¹ä¾¿çš„å·¥å…·ã€ç»„ä»¶å’Œæ¥å£ï¼Œå¤§å¤§é™ä½äº† AI åº”ç”¨å¼€å‘çš„é—¨æ§›ï¼Œä¹Ÿæå¤§ç®€åŒ–äº†å¤§æ¨¡å‹åº”ç”¨ç¨‹åºçš„å¼€å‘è¿‡ç¨‹ã€‚

---

## 1. ä»€ä¹ˆæ˜¯ LangChainï¼Ÿ

LangChain æ˜¯ä¸€ä¸ª**ç”¨äºå¼€å‘ LLM é©±åŠ¨åº”ç”¨ç¨‹åºçš„æ¡†æ¶**ã€‚å®ƒæä¾›äº†ä¸€å¥—å·¥å…·å’ŒæŠ½è±¡ï¼Œå¸®åŠ©å¼€å‘è€…æ›´å®¹æ˜“åœ°æ„å»ºå¤æ‚çš„ AI åº”ç”¨ï¼Œå¦‚èŠå¤©æœºå™¨äººã€RAG ç³»ç»Ÿã€AI Agent ç­‰ã€‚

ç®€å•æ¥è¯´ï¼š**LangChain æ˜¯ AI åº”ç”¨çš„"ä¹é«˜ç§¯æœ¨"â€”â€”æä¾›æ ‡å‡†åŒ–ç»„ä»¶ï¼Œè®©ä½ æ‹¼è£…å‡ºå¤æ‚çš„ AI ç³»ç»Ÿã€‚**

## 2. ä¸ºä»€ä¹ˆéœ€è¦ LangChainï¼Ÿ

### 2.1 ç›´æ¥è°ƒç”¨ API çš„é—®é¢˜

```python
# ä¸ç”¨ LangChainï¼šç›´æ¥è°ƒç”¨ OpenAI API
from openai import OpenAI
client = OpenAI()

# é—®é¢˜ 1ï¼šåˆ‡æ¢æ¨¡å‹éœ€è¦æ”¹ä»£ç 
response = client.chat.completions.create(
    model="gpt-4",
    messages=[{"role": "user", "content": "ä½ å¥½"}]
)

# é—®é¢˜ 2ï¼šæƒ³åŠ è®°å¿†åŠŸèƒ½ï¼Ÿè‡ªå·±å†™
conversation_history = []
conversation_history.append({"role": "user", "content": "ä½ å¥½"})
# ... è¿˜è¦å¤„ç†é•¿åº¦é™åˆ¶ã€å­˜å‚¨ç­‰

# é—®é¢˜ 3ï¼šæƒ³è®© AI è°ƒç”¨å·¥å…·ï¼Ÿå¤æ‚çš„é€»è¾‘
# éœ€è¦è‡ªå·±è§£æ AI è¾“å‡ºã€è°ƒç”¨å‡½æ•°ã€å¤„ç†ç»“æœ...

# é—®é¢˜ 4ï¼šæƒ³åš RAGï¼Ÿä»é›¶å¼€å§‹
# æ–‡æ¡£åŠ è½½ã€åˆ†å—ã€å‘é‡åŒ–ã€æ£€ç´¢ã€ç»„è£…æç¤ºè¯...
```

### 2.2 LangChain çš„è§£å†³æ–¹æ¡ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   LangChain è§£å†³çš„é—®é¢˜                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  é—®é¢˜                          LangChain æ–¹æ¡ˆ                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  åˆ‡æ¢æ¨¡å‹éœ€è¦æ”¹ä»£ç         â†’   ç»Ÿä¸€çš„æ¨¡å‹æ¥å£æŠ½è±¡               â”‚
â”‚  å®ç°å¯¹è¯è®°å¿†å¾ˆç¹ç        â†’   å†…ç½® Memory ç»„ä»¶                 â”‚
â”‚  è®© AI ä½¿ç”¨å·¥å…·å¾ˆå¤æ‚      â†’   Tool/Agent æ¡†æ¶                 â”‚
â”‚  æ„å»º RAG ä»é›¶å¼€å§‹        â†’   æ–‡æ¡£åŠ è½½ã€å‘é‡å­˜å‚¨ç­‰ç»„ä»¶         â”‚
â”‚  æµç¨‹ç¼–æ’å›°éš¾             â†’   Chain/LCEL ç¼–æ’ç³»ç»Ÿ              â”‚
â”‚  è°ƒè¯•å’Œç›‘æ§ä¸æ–¹ä¾¿         â†’   LangSmith è¿½è¸ªå¹³å°               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3. LangChain èƒ½å¹²ä»€ä¹ˆï¼Ÿ

### 3.1 æ ¸å¿ƒèƒ½åŠ›æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LangChain èƒ½åŠ›å›¾è°±                            â”‚
â”‚                                                                  â”‚
â”‚   ğŸ¤– æ¨¡å‹é›†æˆ              ğŸ“š çŸ¥è¯†å¢å¼º (RAG)     ğŸ”§ å·¥å…·ä½¿ç”¨     â”‚
â”‚   â”œâ”€â”€ OpenAI              â”œâ”€â”€ æ–‡æ¡£åŠ è½½         â”œâ”€â”€ æœç´¢å¼•æ“    â”‚
â”‚   â”œâ”€â”€ Anthropic           â”œâ”€â”€ æ–‡æœ¬åˆ†å—         â”œâ”€â”€ è®¡ç®—å™¨      â”‚
â”‚   â”œâ”€â”€ Ollama (æœ¬åœ°)       â”œâ”€â”€ å‘é‡å­˜å‚¨         â”œâ”€â”€ ä»£ç æ‰§è¡Œ    â”‚
â”‚   â”œâ”€â”€ Azure               â”œâ”€â”€ ç›¸ä¼¼æ£€ç´¢         â”œâ”€â”€ API è°ƒç”¨    â”‚
â”‚   â””â”€â”€ 100+ æ¨¡å‹           â””â”€â”€ ä¸Šä¸‹æ–‡æ³¨å…¥       â””â”€â”€ è‡ªå®šä¹‰å·¥å…·  â”‚
â”‚                                                                  â”‚
â”‚   ğŸ”— æµç¨‹ç¼–æ’              ğŸ§  è®°å¿†ç®¡ç†          ğŸ¤– Agent ç³»ç»Ÿ   â”‚
â”‚   â”œâ”€â”€ Chain é“¾å¼è°ƒç”¨      â”œâ”€â”€ å¯¹è¯å†å²         â”œâ”€â”€ ReAct       â”‚
â”‚   â”œâ”€â”€ LCEL è¡¨è¾¾å¼         â”œâ”€â”€ æ‘˜è¦è®°å¿†         â”œâ”€â”€ Plan & Executeâ”‚
â”‚   â”œâ”€â”€ æ¡ä»¶åˆ†æ”¯            â”œâ”€â”€ çŸ¥è¯†å›¾è°±         â”œâ”€â”€ å¤š Agent    â”‚
â”‚   â””â”€â”€ å¹¶è¡Œæ‰§è¡Œ            â””â”€â”€ é•¿æœŸè®°å¿†         â””â”€â”€ è‡ªä¸»å†³ç­–    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 å…¸å‹åº”ç”¨åœºæ™¯

```
åœºæ™¯ 1: æ™ºèƒ½å®¢æœæœºå™¨äºº
â”œâ”€â”€ ç†è§£ç”¨æˆ·é—®é¢˜
â”œâ”€â”€ æŸ¥è¯¢çŸ¥è¯†åº“ï¼ˆRAGï¼‰
â”œâ”€â”€ è®°ä½å¯¹è¯ä¸Šä¸‹æ–‡
â””â”€â”€ è°ƒç”¨ä¸šåŠ¡ç³»ç»Ÿï¼ˆå·¥å…·ï¼‰

åœºæ™¯ 2: æ–‡æ¡£é—®ç­”ç³»ç»Ÿ
â”œâ”€â”€ åŠ è½½ PDF/Word/ç½‘é¡µ
â”œâ”€â”€ æ™ºèƒ½åˆ†å—å’Œç´¢å¼•
â”œâ”€â”€ è¯­ä¹‰æ£€ç´¢ç›¸å…³å†…å®¹
â””â”€â”€ åŸºäºå†…å®¹ç”Ÿæˆå›ç­”

åœºæ™¯ 3: AI æ•°æ®åˆ†æåŠ©æ‰‹
â”œâ”€â”€ ç†è§£è‡ªç„¶è¯­è¨€æŸ¥è¯¢
â”œâ”€â”€ ç”Ÿæˆ SQL/ä»£ç 
â”œâ”€â”€ æ‰§è¡Œå¹¶è·å–ç»“æœ
â””â”€â”€ è§£é‡Šåˆ†æç»“æœ

åœºæ™¯ 4: è‡ªåŠ¨åŒ– Agent
â”œâ”€â”€ ç†è§£å¤æ‚ä»»åŠ¡
â”œâ”€â”€ æ‹†è§£å­ä»»åŠ¡
â”œâ”€â”€ ä½¿ç”¨å¤šç§å·¥å…·
â””â”€â”€ è‡ªä¸»å®Œæˆç›®æ ‡
```

## 4. LangChain çš„å·¥ä½œåŸç†

### 4.1 æ ¸å¿ƒæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LangChain æ¶æ„                                â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    åº”ç”¨å±‚                                â”‚    â”‚
â”‚  â”‚         (ä½ çš„ä»£ç ï¼šèŠå¤©æœºå™¨äººã€RAG ç³»ç»Ÿç­‰)              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                  LangChain æ ¸å¿ƒå±‚                        â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚  Model   â”‚ â”‚  Chain   â”‚ â”‚  Memory  â”‚ â”‚  Agent   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ æ¨¡å‹æŠ½è±¡ â”‚ â”‚ æµç¨‹ç¼–æ’ â”‚ â”‚ è®°å¿†ç®¡ç† â”‚ â”‚ æ™ºèƒ½ä»£ç† â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚ Retrieverâ”‚ â”‚  Tools   â”‚ â”‚ Prompt   â”‚ â”‚ Output   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ æ£€ç´¢å™¨   â”‚ â”‚  å·¥å…·    â”‚ â”‚ æç¤ºè¯   â”‚ â”‚ è§£æå™¨   â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    é›†æˆå±‚                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚  LLM     â”‚ â”‚  Vector  â”‚ â”‚ Document â”‚ â”‚ External â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ Providersâ”‚ â”‚  Stores  â”‚ â”‚ Loaders  â”‚ â”‚  APIs    â”‚   â”‚    â”‚
â”‚  â”‚  â”‚OpenAIç­‰  â”‚ â”‚Pineconeç­‰â”‚ â”‚PDF/Webç­‰ â”‚ â”‚æœç´¢/æ•°æ®åº“â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 æ ¸å¿ƒç»„ä»¶è¯¦è§£

#### 4.2.1 Modelï¼ˆæ¨¡å‹æŠ½è±¡ï¼‰

```python
# LangChain ç»Ÿä¸€äº†ä¸åŒæ¨¡å‹çš„è°ƒç”¨æ–¹å¼

# OpenAI
from langchain_openai import ChatOpenAI
llm = ChatOpenAI(model="gpt-4")

# Anthropic Claude
from langchain_anthropic import ChatAnthropic
llm = ChatAnthropic(model="claude-3-sonnet")

# Ollama æœ¬åœ°æ¨¡å‹
from langchain_ollama import ChatOllama
llm = ChatOllama(model="llama3.2")

# è°ƒç”¨æ–¹å¼å®Œå…¨ç›¸åŒï¼
response = llm.invoke("ä½ å¥½")
```

```
æ¨¡å‹æŠ½è±¡çš„ä»·å€¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚   ç»Ÿä¸€æ¥å£                                                   â”‚
â”‚   llm.invoke(messages)                                      â”‚
â”‚        â”‚                                                     â”‚
â”‚        â”œâ”€â”€â–º OpenAI API                                      â”‚
â”‚        â”œâ”€â”€â–º Anthropic API                                   â”‚
â”‚        â”œâ”€â”€â–º Ollama æœ¬åœ°                                     â”‚
â”‚        â””â”€â”€â–º å…¶ä»– 100+ æ¨¡å‹                                  â”‚
â”‚                                                              â”‚
â”‚   å¥½å¤„ï¼šåˆ‡æ¢æ¨¡å‹åªéœ€æ”¹ä¸€è¡Œä»£ç ï¼Œä¸šåŠ¡é€»è¾‘æ— éœ€ä¿®æ”¹             â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.2.2 Prompt Templateï¼ˆæç¤ºè¯æ¨¡æ¿ï¼‰

```python
from langchain_core.prompts import ChatPromptTemplate

# åˆ›å»ºæ¨¡æ¿
prompt = ChatPromptTemplate.from_messages([
    ("system", "ä½ æ˜¯ä¸€ä¸ª{role}ï¼Œè¯·ç”¨{style}é£æ ¼å›ç­”ã€‚"),
    ("human", "{question}")
])

# ä½¿ç”¨æ¨¡æ¿
messages = prompt.invoke({
    "role": "Pythonä¸“å®¶",
    "style": "ç®€æ´",
    "question": "ä»€ä¹ˆæ˜¯è£…é¥°å™¨ï¼Ÿ"
})
```

```
Prompt Template å·¥ä½œåŸç†ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚   æ¨¡æ¿å®šä¹‰                      å®é™…è¾“å…¥                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚   â”‚ system: ä½ æ˜¯{role}  â”‚     â”‚ role: "Pythonä¸“å®¶"  â”‚       â”‚
â”‚   â”‚ human: {question}   â”‚ â”€â”€â–º â”‚ question: "ä»€ä¹ˆæ˜¯..." â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                        â”‚                     â”‚
â”‚                                        â–¼                     â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                         â”‚ æ¸²æŸ“åçš„æ¶ˆæ¯             â”‚         â”‚
â”‚                         â”‚ system: ä½ æ˜¯Pythonä¸“å®¶  â”‚         â”‚
â”‚                         â”‚ human: ä»€ä¹ˆæ˜¯è£…é¥°å™¨ï¼Ÿ   â”‚         â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.2.3 Chainï¼ˆé“¾å¼è°ƒç”¨ï¼‰

```python
# LCEL (LangChain Expression Language) é“¾å¼è¯­æ³•
from langchain_openai import ChatOpenAI
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser

# æ„å»ºå¤„ç†é“¾
chain = (
    ChatPromptTemplate.from_template("æŠŠä»¥ä¸‹å†…å®¹ç¿»è¯‘æˆè‹±æ–‡ï¼š{text}")
    | ChatOpenAI()
    | StrOutputParser()
)

# æ‰§è¡Œ
result = chain.invoke({"text": "ä½ å¥½ä¸–ç•Œ"})
# è¾“å‡º: "Hello World"
```

```
Chain æ‰§è¡Œæµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚   è¾“å…¥: {"text": "ä½ å¥½ä¸–ç•Œ"}                                â”‚
â”‚            â”‚                                                 â”‚
â”‚            â–¼                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚   â”‚   Prompt Template   â”‚  "æŠŠä»¥ä¸‹å†…å®¹ç¿»è¯‘æˆè‹±æ–‡ï¼šä½ å¥½ä¸–ç•Œ" â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚              â”‚                                               â”‚
â”‚              â–¼                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚   â”‚      ChatOpenAI     â”‚  è°ƒç”¨ GPTï¼Œè¿”å› AI Message        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚              â”‚                                               â”‚
â”‚              â–¼                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚   â”‚  StrOutputParser    â”‚  æå–æ–‡æœ¬å†…å®¹                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚              â”‚                                               â”‚
â”‚              â–¼                                               â”‚
â”‚   è¾“å‡º: "Hello World"                                        â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.2.4 RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰

```python
from langchain_community.document_loaders import PyPDFLoader
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain_openai import OpenAIEmbeddings
from langchain_community.vectorstores import FAISS

# 1. åŠ è½½æ–‡æ¡£
loader = PyPDFLoader("document.pdf")
documents = loader.load()

# 2. åˆ†å—
splitter = RecursiveCharacterTextSplitter(chunk_size=1000)
chunks = splitter.split_documents(documents)

# 3. å‘é‡åŒ–å¹¶å­˜å‚¨
embeddings = OpenAIEmbeddings()
vectorstore = FAISS.from_documents(chunks, embeddings)

# 4. æ£€ç´¢
retriever = vectorstore.as_retriever()
relevant_docs = retriever.invoke("ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ")
```

```
RAG å®Œæ•´æµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚   ã€ç´¢å¼•é˜¶æ®µ - ç¦»çº¿å¤„ç†ã€‘                                    â”‚
â”‚                                                              â”‚
â”‚   æ–‡æ¡£ â”€â”€â–º åŠ è½½ â”€â”€â–º åˆ†å— â”€â”€â–º Embedding â”€â”€â–º å‘é‡æ•°æ®åº“       â”‚
â”‚   PDF      loader   splitter   å‘é‡åŒ–       FAISS/Pinecone  â”‚
â”‚                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   ã€æŸ¥è¯¢é˜¶æ®µ - å®æ—¶å¤„ç†ã€‘                                    â”‚
â”‚                                                              â”‚
â”‚   ç”¨æˆ·é—®é¢˜: "ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ"                               â”‚
â”‚        â”‚                                                     â”‚
â”‚        â–¼                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚   â”‚   Embedding     â”‚  é—®é¢˜ â†’ å‘é‡                          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚            â”‚                                                 â”‚
â”‚            â–¼                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚   â”‚   å‘é‡æ£€ç´¢       â”‚  æ‰¾åˆ°æœ€ç›¸å…³çš„ N ä¸ªæ–‡æ¡£å—              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚            â”‚                                                 â”‚
â”‚            â–¼                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚   â”‚   ç»„è£… Prompt    â”‚  "æ ¹æ®ä»¥ä¸‹å†…å®¹å›ç­”ï¼š\n{æ–‡æ¡£}\né—®é¢˜ï¼š" â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚            â”‚                                                 â”‚
â”‚            â–¼                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚   â”‚      LLM        â”‚  ç”ŸæˆåŸºäºæ£€ç´¢å†…å®¹çš„å›ç­”               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚            â”‚                                                 â”‚
â”‚            â–¼                                                 â”‚
â”‚   å›ç­”: "æœºå™¨å­¦ä¹ æ˜¯ä¸€ç§..."                                  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.2.5 Agentï¼ˆæ™ºèƒ½ä»£ç†ï¼‰

```python
from langchain_openai import ChatOpenAI
from langchain.agents import create_react_agent, AgentExecutor
from langchain.tools import tool

# å®šä¹‰å·¥å…·
@tool
def search(query: str) -> str:
    """æœç´¢äº’è”ç½‘è·å–ä¿¡æ¯"""
    # å®é™…æœç´¢é€»è¾‘
    return f"æœç´¢ç»“æœï¼š{query}"

@tool
def calculator(expression: str) -> str:
    """è®¡ç®—æ•°å­¦è¡¨è¾¾å¼"""
    return str(eval(expression))

# åˆ›å»º Agent
tools = [search, calculator]
llm = ChatOpenAI(model="gpt-4")
agent = create_react_agent(llm, tools, prompt)
agent_executor = AgentExecutor(agent=agent, tools=tools)

# æ‰§è¡Œ
result = agent_executor.invoke({
    "input": "åŒ—äº¬ä»Šå¤©çš„æ°”æ¸©æ˜¯å¤šå°‘ï¼Ÿå¦‚æœæ¸©åº¦å¤§äº30åº¦ï¼Œè®¡ç®—30çš„å¹³æ–¹"
})
```

```
Agent (ReAct) æ‰§è¡Œæµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚   ä»»åŠ¡: "åŒ—äº¬æ°”æ¸©å¤šå°‘ï¼Ÿå¦‚æœ>30åº¦ï¼Œè®¡ç®—30çš„å¹³æ–¹"              â”‚
â”‚        â”‚                                                     â”‚
â”‚        â–¼                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ Thought: æˆ‘éœ€è¦å…ˆæœç´¢åŒ—äº¬çš„æ°”æ¸©                      â”‚   â”‚
â”‚   â”‚ Action: search                                       â”‚   â”‚
â”‚   â”‚ Action Input: "åŒ—äº¬ä»Šå¤©æ°”æ¸©"                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                               â”‚
â”‚                              â–¼                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ Observation: æœç´¢ç»“æœï¼šåŒ—äº¬ä»Šå¤©æ°”æ¸© 32Â°C            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                               â”‚
â”‚                              â–¼                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ Thought: æ°”æ¸©æ˜¯32åº¦ï¼Œå¤§äº30ï¼Œéœ€è¦è®¡ç®—30çš„å¹³æ–¹        â”‚   â”‚
â”‚   â”‚ Action: calculator                                   â”‚   â”‚
â”‚   â”‚ Action Input: "30 ** 2"                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                               â”‚
â”‚                              â–¼                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ Observation: 900                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                               â”‚
â”‚                              â–¼                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ Thought: æˆ‘å·²ç»è·å¾—äº†æ‰€æœ‰éœ€è¦çš„ä¿¡æ¯                  â”‚   â”‚
â”‚   â”‚ Final Answer: åŒ—äº¬ä»Šå¤©æ°”æ¸©32Â°Cï¼Œ30çš„å¹³æ–¹æ˜¯900       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.2.6 Memoryï¼ˆè®°å¿†ç®¡ç†ï¼‰

```python
from langchain.memory import ConversationBufferMemory
from langchain_openai import ChatOpenAI
from langchain.chains import ConversationChain

# åˆ›å»ºå¸¦è®°å¿†çš„å¯¹è¯é“¾
memory = ConversationBufferMemory()
llm = ChatOpenAI()
conversation = ConversationChain(llm=llm, memory=memory)

# å¯¹è¯
conversation.invoke({"input": "æˆ‘å«å¼ ä¸‰"})
# AI: ä½ å¥½å¼ ä¸‰ï¼Œå¾ˆé«˜å…´è®¤è¯†ä½ ï¼

conversation.invoke({"input": "æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ"})
# AI: ä½ å«å¼ ä¸‰ã€‚
```

```
Memory ç±»å‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚  ConversationBufferMemory    â”€â”€â”€ ä¿å­˜å®Œæ•´å¯¹è¯å†å²           â”‚
â”‚  æœ€ç®€å•ï¼Œä½† token æ¶ˆè€—å¤§                                    â”‚
â”‚                                                              â”‚
â”‚  ConversationSummaryMemory   â”€â”€â”€ ä¿å­˜å¯¹è¯æ‘˜è¦               â”‚
â”‚  é€‚åˆé•¿å¯¹è¯ï¼Œç”¨ LLM ç”Ÿæˆæ‘˜è¦                                â”‚
â”‚                                                              â”‚
â”‚  ConversationBufferWindowMemory â”€ ä¿å­˜æœ€è¿‘ N è½®å¯¹è¯        â”‚
â”‚  å›ºå®šçª—å£å¤§å°ï¼Œæ§åˆ¶ token æ¶ˆè€—                              â”‚
â”‚                                                              â”‚
â”‚  VectorStoreRetrieverMemory  â”€â”€â”€ å‘é‡æ£€ç´¢ç›¸å…³è®°å¿†           â”‚
â”‚  é€‚åˆéœ€è¦é•¿æœŸè®°å¿†çš„åœºæ™¯                                     â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 5. LangChain ç”Ÿæ€

### 5.1 å®˜æ–¹ç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LangChain ç”Ÿæ€ç³»ç»Ÿ                        â”‚
â”‚                                                              â”‚
â”‚  langchain-core        â”€â”€â”€ æ ¸å¿ƒæŠ½è±¡å’Œæ¥å£                   â”‚
â”‚  langchain             â”€â”€â”€ ä¸»æ¡†æ¶ï¼Œé“¾ã€Agent ç­‰             â”‚
â”‚  langchain-community   â”€â”€â”€ ç¤¾åŒºé›†æˆï¼ˆç¬¬ä¸‰æ–¹æœåŠ¡ï¼‰           â”‚
â”‚  langchain-openai      â”€â”€â”€ OpenAI å®˜æ–¹é›†æˆ                  â”‚
â”‚  langchain-anthropic   â”€â”€â”€ Anthropic å®˜æ–¹é›†æˆ               â”‚
â”‚                                                              â”‚
â”‚  LangGraph             â”€â”€â”€ å¤æ‚ Agent å·¥ä½œæµæ¡†æ¶            â”‚
â”‚  LangServe             â”€â”€â”€ éƒ¨ç½² Chain ä¸º REST API           â”‚
â”‚  LangSmith             â”€â”€â”€ è¿½è¸ªã€è°ƒè¯•ã€ç›‘æ§å¹³å°             â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 LangGraph ç®€ä»‹

```python
# LangGraph: ç”¨äºæ„å»ºå¤æ‚ Agent å·¥ä½œæµ
from langgraph.graph import StateGraph, END

# å®šä¹‰çŠ¶æ€
class AgentState(TypedDict):
    messages: list
    next_step: str

# åˆ›å»ºå›¾
workflow = StateGraph(AgentState)

# æ·»åŠ èŠ‚ç‚¹
workflow.add_node("research", research_node)
workflow.add_node("write", write_node)
workflow.add_node("review", review_node)

# æ·»åŠ è¾¹ï¼ˆæµç¨‹æ§åˆ¶ï¼‰
workflow.add_edge("research", "write")
workflow.add_conditional_edges("write", should_review, {
    "review": "review",
    "end": END
})
```

## 6. ä¸å¸‚é¢äº§å“çš„å¯¹æ¯”

### 6.1 AI åº”ç”¨æ¡†æ¶å¯¹æ¯”

| ç‰¹æ€§ | LangChain | LlamaIndex | Semantic Kernel | Haystack |
|------|-----------|------------|-----------------|----------|
| **å®šä½** | é€šç”¨ AI åº”ç”¨ | RAG ä¸“ç²¾ | å¾®è½¯ç”Ÿæ€ | æœç´¢/RAG |
| **å­¦ä¹ æ›²çº¿** | ä¸­ç­‰ | è¾ƒä½ | è¾ƒé«˜ | ä¸­ç­‰ |
| **ç”Ÿæ€ä¸°å¯Œåº¦** | â­â­â­ | â­â­ | â­â­ | â­â­ |
| **Agent æ”¯æŒ** | å¼º | ä¸­ | ä¸­ | å¼± |
| **RAG èƒ½åŠ›** | å¼º | æœ€å¼º | ä¸­ | å¼º |
| **ä¼ä¸šæ”¯æŒ** | å¥½ | å¥½ | æœ€å¥½(å¾®è½¯) | å¥½ |
| **è¯­è¨€** | Python/JS | Python | Python/C#/Java | Python |

### 6.2 ä»€ä¹ˆæ—¶å€™ç”¨ LangChainï¼Ÿ

```
é€‰æ‹© LangChain å½“ä½ ï¼š
â”œâ”€â”€ éœ€è¦æ„å»ºå¤æ‚çš„ AI åº”ç”¨ï¼ˆä¸åªæ˜¯ç®€å•èŠå¤©ï¼‰
â”œâ”€â”€ éœ€è¦ Agent èƒ½åŠ›ï¼ˆAI ä½¿ç”¨å·¥å…·ï¼‰
â”œâ”€â”€ éœ€è¦ RAGï¼ˆçŸ¥è¯†åº“é—®ç­”ï¼‰
â”œâ”€â”€ æƒ³è¦çµæ´»åˆ‡æ¢ä¸åŒçš„ LLM
â”œâ”€â”€ éœ€è¦å¯¹è¯è®°å¿†ç®¡ç†
â””â”€â”€ è¿½æ±‚æˆç†Ÿçš„ç”Ÿæ€å’Œç¤¾åŒºæ”¯æŒ

é€‰æ‹©ç›´æ¥è°ƒç”¨ API å½“ä½ ï¼š
â”œâ”€â”€ åªéœ€è¦ç®€å•çš„å¯¹è¯åŠŸèƒ½
â”œâ”€â”€ åº”ç”¨é€»è¾‘éå¸¸ç®€å•
â”œâ”€â”€ ä¸æƒ³å¢åŠ é¢å¤–ä¾èµ–
â””â”€â”€ å¯¹æ€§èƒ½æœ‰æè‡´è¦æ±‚

é€‰æ‹© LlamaIndex å½“ä½ ï¼š
â”œâ”€â”€ ä¸»è¦éœ€æ±‚æ˜¯ RAG/æ–‡æ¡£é—®ç­”
â”œâ”€â”€ éœ€è¦æ›´ç²¾ç»†çš„ç´¢å¼•æ§åˆ¶
â””â”€â”€ ä¸éœ€è¦å¤æ‚çš„ Agent åŠŸèƒ½
```

## 7. å¿«é€Ÿä¸Šæ‰‹

### 7.1 å®‰è£…

```bash
# æ ¸å¿ƒåŒ…
pip install langchain langchain-core

# æ ¹æ®éœ€è¦å®‰è£…é›†æˆ
pip install langchain-openai      # OpenAI
pip install langchain-anthropic   # Claude
pip install langchain-ollama      # Ollama æœ¬åœ°æ¨¡å‹
pip install langchain-community   # ç¤¾åŒºé›†æˆ

# å¯é€‰å·¥å…·
pip install faiss-cpu             # å‘é‡å­˜å‚¨
pip install pypdf                 # PDF åŠ è½½
```

### 7.2 åŸºç¡€ç¤ºä¾‹

```python
# æœ€ç®€å•çš„è°ƒç”¨
from langchain_openai import ChatOpenAI

llm = ChatOpenAI(model="gpt-4")
response = llm.invoke("ç”¨ä¸€å¥è¯è§£é‡Šä»€ä¹ˆæ˜¯ AI")
print(response.content)
```

### 7.3 å®Œæ•´ RAG ç¤ºä¾‹

```python
from langchain_openai import ChatOpenAI, OpenAIEmbeddings
from langchain_community.document_loaders import WebBaseLoader
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain_community.vectorstores import FAISS
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser
from langchain_core.runnables import RunnablePassthrough

# 1. åŠ è½½ç½‘é¡µå†…å®¹
loader = WebBaseLoader("https://example.com/article")
docs = loader.load()

# 2. åˆ†å—
splitter = RecursiveCharacterTextSplitter(chunk_size=500, chunk_overlap=50)
chunks = splitter.split_documents(docs)

# 3. åˆ›å»ºå‘é‡å­˜å‚¨
embeddings = OpenAIEmbeddings()
vectorstore = FAISS.from_documents(chunks, embeddings)
retriever = vectorstore.as_retriever()

# 4. åˆ›å»º RAG Chain
template = """æ ¹æ®ä»¥ä¸‹å†…å®¹å›ç­”é—®é¢˜ï¼š
{context}

é—®é¢˜ï¼š{question}
"""
prompt = ChatPromptTemplate.from_template(template)

rag_chain = (
    {"context": retriever, "question": RunnablePassthrough()}
    | prompt
    | ChatOpenAI()
    | StrOutputParser()
)

# 5. ä½¿ç”¨
answer = rag_chain.invoke("è¿™ç¯‡æ–‡ç« çš„ä¸»è¦è§‚ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ")
print(answer)
```

### 7.4 ä½¿ç”¨ Ollama æœ¬åœ°æ¨¡å‹

```python
from langchain_ollama import ChatOllama

# ä½¿ç”¨æœ¬åœ° Ollama æ¨¡å‹
llm = ChatOllama(model="llama3.2")

response = llm.invoke("ä»€ä¹ˆæ˜¯ Python è£…é¥°å™¨ï¼Ÿ")
print(response.content)
```

## 8. æ€»ç»“

**LangChain çš„å®šä½**ï¼š
- **AI åº”ç”¨å¼€å‘æ¡†æ¶**
- æä¾›**æ ‡å‡†åŒ–ç»„ä»¶**å’Œ**æŠ½è±¡å±‚**
- è®©æ„å»ºå¤æ‚ AI åº”ç”¨**æ›´ç®€å•ã€æ›´å¿«**

**æ ¸å¿ƒä»·å€¼**ï¼š
```
æŠ½è±¡ + ç»„ä»¶ + ç”Ÿæ€ = LangChain

æŠŠå¤æ‚çš„ AI åº”ç”¨æ‹†è§£æˆå¯ç»„åˆçš„ä¹é«˜ç§¯æœ¨ã€‚
```

**é€‚åˆäººç¾¤**ï¼š
- æ„å»º AI åº”ç”¨çš„å¼€å‘è€…
- éœ€è¦ RAG/Agent èƒ½åŠ›çš„é¡¹ç›®
- å¸Œæœ›å¿«é€ŸåŸå‹éªŒè¯çš„å›¢é˜Ÿ
- éœ€è¦çµæ´»åˆ‡æ¢æ¨¡å‹çš„åœºæ™¯

**è®°ä½**ï¼š
- LangChain ä¸æ˜¯ AI æ¨¡å‹ï¼Œæ˜¯**è°ƒç”¨å’Œç¼–æ’æ¨¡å‹çš„æ¡†æ¶**
- é€‚åˆä¸­ç­‰å¤æ‚åº¦ä»¥ä¸Šçš„åº”ç”¨
- ç®€å•éœ€æ±‚ç›´æ¥è°ƒç”¨ API å¯èƒ½æ›´åˆé€‚
